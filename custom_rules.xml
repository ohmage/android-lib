<?xml version="1.0" encoding="UTF-8"?>
<project name="ohmage">
  <target name="-pre-build">
    <!-- put the commit hash in the strings.xml file -->
  	<exec executable="git" outputproperty="git.revision" failifexecutionfails="true">
      <arg value="rev-parse"/>
      <arg value="--short"/>
      <arg value="HEAD"/>
    </exec>
    <replaceregexp file="res/values/strings.xml"
      match="&lt;string name=&quot;commit_hash&quot;&gt;.*&lt;/string&gt;"
      replace="&lt;string name=&quot;commit_hash&quot;&gt;${git.revision}&lt;/string&gt;" />
  </target>

  <target name="-post-build">
    <!-- remove the commit hash from the strings.xml file -->
    <replaceregexp file="res/values/strings.xml"
      match="&lt;string name=&quot;commit_hash&quot;&gt;.*&lt;/string&gt;"
      replace="&lt;string name=&quot;commit_hash&quot;&gt;meow&lt;/string&gt;" />
  </target>
</project>